<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="阳光夜风"><title>LeetCode "546. Remove Boxes" · 阳光夜风</title><!-- hexo-inject:begin --><!-- hexo-inject:end --><meta name="description" content="LeetCode link
first thought
The same as Matrix chain multiplication, the maximum value from i to j is equal to the max of it’s sub cases.


choose i ,"><meta name="keywords" content="iOS, Apple Foundation, Machine Learning, Algorithm, LeetCode"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">阳光夜风</a></h3><div class="description"><p>上善若水 大盈若冲</p></div></div></div><ul class="social-links"><li><a href="http://weibo.com/1685261185"><i class="fa fa-weibo"></i></a></li></ul><div class="footer"></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/categories/">分类</a></li><li><a href="/tags">标签</a></li><li><a href="/archives">归档</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"></a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>LeetCode &quot;546. Remove Boxes&quot;</a></h3></div><div class="post-content"><p><a href="https://leetcode.com/problems/remove-boxes/description/" target="_blank" rel="external">LeetCode link</a></p>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><h3 id="first-thought"><a href="#first-thought" class="headerlink" title="first thought"></a>first thought</h3><ul>
<li>The same as Matrix chain multiplication, the maximum value from i to j is equal to the max of it’s sub cases.</li>
</ul>
<ol>
<li>choose i ,choose i+1 to j-1, choose j</li>
<li>choose i ,choose i+1 to j</li>
<li>choose i to j-1, choose j</li>
</ol>
<p><strong>solution</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">class Solution &#123;</div><div class="line">    public int removeBoxes(int[] boxes) &#123;</div><div class="line">        if (boxes == null || boxes.length &lt; 1) &#123;</div><div class="line">            return 0;</div><div class="line">        &#125;</div><div class="line">        int n = boxes.length;</div><div class="line">        if (n == 1) &#123;</div><div class="line">            return 1;</div><div class="line">        &#125;</div><div class="line">        int[][] dp = new int[n][n];</div><div class="line">        for (int i = 0; i &lt; n; i++) &#123;</div><div class="line">            dp[i][i] = 1;</div><div class="line">            if (i &lt; n - 1) &#123;</div><div class="line">                dp[i][i + 1] = dp[i] == dp[i + 1] ? 4 : 2;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        for (int k = 1; k &lt; n - 1; k++) &#123;</div><div class="line">            for (int i = 0; i &lt; n - k; i++) &#123;</div><div class="line">                int j = i + k;</div><div class="line">                int s1 = 1 + dp[i + 1][j - 1] + 1;</div><div class="line">                int s2 = 1 + dp[i + 1][j];</div><div class="line">                int s3 = dp[i][j - 1] + 1;</div><div class="line">                if (dp[i] == dp[j]) &#123;</div><div class="line">                    s1 = 4 + dp[i + 1][j - 1];</div><div class="line">                &#125;</div><div class="line">                dp[i][j] = Math.max(s1, Math.max(s2, s3));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return dp[0][n - 1];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>problem</strong></p>
<p>WA.</p>
<p><strong>reason</strong></p>
<p>It’s not the same as matrix ,because in the matrix we multiplicate one number each time, but in this problem, different split can influence the combination result as we can choose not only one number each time.</p>
<hr>
<p><strong>modification</strong></p>
<p>The DFS answer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">class Solution &#123;</div><div class="line">    public int removeBoxes(int[] boxes) &#123;</div><div class="line">        if (boxes == null || boxes.length &lt; 1) &#123;</div><div class="line">            return 0;</div><div class="line">        &#125;</div><div class="line">        int n = boxes.length;</div><div class="line">        int[][][] scores = new int[n][n][n];</div><div class="line">        return this.dfs(boxes, 0, n - 1, 0, scores);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private int dfs(int[] boxes, int i, int j, int k, int[][][] scores) &#123;</div><div class="line">        if (i &gt; j) &#123;</div><div class="line">            return 0;</div><div class="line">        &#125;</div><div class="line">        if (scores[i][j][k] &gt; 0) &#123;</div><div class="line">            return scores[i][j][k];</div><div class="line">        &#125;</div><div class="line">        int result = (1 + k) * (1 + k) + this.dfs(boxes, i + 1, j , 0, scores);</div><div class="line">        for (int r = i + 1; r &lt;= j; r++) &#123;</div><div class="line">            if (boxes[r] == boxes[i]) &#123;</div><div class="line">                result = Math.max(result, this.dfs(boxes, i + 1, r - 1, 0, scores) + this.dfs(boxes, r, j, k + 1, scores));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        scores[i][j][k] = result;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><strong>another solution</strong></p>
<ul>
<li>According to the DFS solution, here’s the DP solution.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">class Solution &#123;</div><div class="line">    public int removeBoxes(int[] boxes) &#123;</div><div class="line">        if (boxes == null || boxes.length &lt; 1) &#123;</div><div class="line">            return 0;</div><div class="line">        &#125;</div><div class="line">        int n = boxes.length;</div><div class="line">        int[][][] scores = new int[n][n][n];</div><div class="line">        for (int i = 0; i &lt; n; i++) &#123;</div><div class="line">            for (int k = 0; k &lt; n; k++) &#123;</div><div class="line">                scores[i][i][k] = (1 + k) * (1 + k);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        for (int r = 1; r &lt; n; r++) &#123;</div><div class="line">            for (int i = 0; i + r &lt; n; i++) &#123;</div><div class="line">                int j = i + r;</div><div class="line">                for (int k = 0; k &lt;= i; k ++) &#123;</div><div class="line">                    int result = (1 + k) * (1 + k) + scores[i + 1][j][0];</div><div class="line">                    for (int m = i + 1; m &lt;= j; m++) &#123;</div><div class="line">                        if (boxes[m] == boxes[i]) &#123;</div><div class="line">                            result = Math.max(result, scores[i + 1][m - 1][0] + scores[m][j][k + 1]);</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    scores[i][j][k] = result;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return scores[0][n - 1][0];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-08-21</span><i class="fa fa-comment-o"></i><a href="/posts/546-Remove-Boxes/#comments">评论</a><i class="fa fa-tag"></i><a class="tag" href="/categories/算法/" title="算法">算法 </a><a class="tag" href="/tags/算法/" title="算法">算法 </a><a class="tag" href="/tags/algorithm/" title="algorithm">algorithm </a><a class="tag" href="/tags/LeetCode/" title="LeetCode">LeetCode </a><a class="tag" href="/tags/DP/" title="DP">DP </a><a class="tag" href="/tags/动态规划/" title="动态规划">动态规划 </a><a class="tag" href="/tags/Dynamic-Programming/" title="Dynamic Programming">Dynamic Programming </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,https://yhvh009.github.io/posts/546-Remove-Boxes/,阳光夜风,LeetCode &quot;546. Remove Boxes&quot;,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a class="btn" role="navigation" href="/posts/foundation/processes_and_threads/" title="进程（Processes）与线程（Threads）">下一篇</a></li></ul></div><a id="comments"></a><div id="disqus_thread"></div><script>var disqus_shortname = 'yhvh009-github-io';
var disqus_identifier = 'posts/546-Remove-Boxes/';
var disqus_title = 'LeetCode &quot;546. Remove Boxes&quot;';
var disqus_url = 'https://yhvh009.github.io/posts/546-Remove-Boxes/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>